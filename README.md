### README.md

# 合并多个 .docx 文件脚本

## 功能描述

本脚本用于合并同一目录下的所有 `.docx` 文件保存到 `merged.docx`，在 `merged.docx`中保存的每个文件内容前加上文件名，并把文件名保存为标题格式，每个文件内容之间通过分页符进行区分，以便在查看时容易区分不同文件的内容。

## 环境准备

1. **Python环境**：
   - Python 3.x（推荐3.12或更高版本）

2. **安装依赖库**：
   - `python-docx`：用于读取和写入 `.docx` 文件。

   安装方法：
   ```bash
   pip install python-docx
   ```

## 使用方法

1. **编辑脚本**：
   - 修改脚本中的输入和输出目录路径。
   - 脚本默认读取当前目录下的 `.docx` 文件，并将合并后的文件保存在同一目录下。

2. **运行脚本**：
   - 将脚本保存为 `merge_docx.py`。
   - 在命令行或终端中，切换到脚本所在的目录。
   - 运行脚本：
     ```bash
     python merge_docx.py
     ```

## 工作原理和步骤

### 1. 初始化输出文档
- 创建一个新的 Word 文档对象 (`Document`)，用于存放合并后的所有内容。
- 这个新的文档将作为最终输出的文档。

### 2. 遍历指定目录
- 使用 `os.listdir()` 函数列出指定目录下的所有文件。
- 通过 `os.path.join()` 构建每个文件的完整路径。

### 3. 读取每个文件
- 对于每个 `.docx` 文件，使用 `Document` 类读取文件内容。
- 使用 `Document` 类的对象来访问每个文件的内容。

### 4. 添加文件名并设置为标题格式
- 在每个文件内容前添加一个段落，包含文件名。
- 设置这个段落的样式为 `Heading 1`，这将使文件名以加粗的标题形式出现，并利用 Word 的标题样式功能。

### 5. 追加内容
- 将当前文件的所有段落逐段追加到输出文档中。
- 逐段追加可以确保内容不会丢失，并且可以保留原文档中的格式。
- 为了复制段落格式，需要将原文档中的段落样式复制到新文档中。
- 为了复制段落内的文本格式（如加粗、斜体等），需要逐个复制 `Run` 对象，并设置相应的属性。

### 6. 添加分隔符
- 在每个文件内容之后添加一个分页符，以便在打印或查看时更容易区分文件。
- 分页符可以确保每个文件的内容都在新的页面开始，从而清晰地区分不同文件的内容。

### 7. 保存输出文档
- 将最终合并后的文档保存到指定的输出路径。
- 确保输出路径存在，并且有足够的权限写入文件。

### 详细步骤说明

1. **初始化输出文档**
   - 创建一个新的 `Document` 对象，作为最终的输出文档。
   - 这个文档将包含所有合并后的文件内容。

2. **遍历指定目录**
   - 列出指定目录下的所有文件，只处理 `.docx` 文件。
   - 使用 `os.path.join()` 构建每个文件的完整路径，确保路径格式正确。

3. **读取每个文件**
   - 使用 `Document` 类读取每个 `.docx` 文件的内容。
   - 每个文件将被逐段处理。

4. **添加文件名并设置为标题格式**
   - 在每个文件内容前添加一个段落，包含文件名。
   - 设置段落样式为 `Heading 1`，这将使文件名以加粗的标题形式出现，并利用 Word 的标题样式功能。

5. **追加内容**
   - 逐段追加当前文件的内容到输出文档中。
   - 复制原文档中的段落样式，确保格式一致。
   - 复制原文档中的 `Run` 对象，并设置相应的属性（如加粗、斜体等）。

6. **添加分隔符**
   - 在每个文件内容之后添加一个分页符。
   - 分页符可以确保每个文件的内容都在新的页面开始，从而清晰地区分不同文件的内容。

7. **保存输出文档**
   - 将最终合并后的文档保存到指定的输出路径。
   - 确保输出路径存在，并且有足够的权限写入文件。

## 注意事项

1. **路径格式**：
   - 在Windows系统中，路径中的反斜杠 `\` 需要转义为 `\\`，或者使用原始字符串 `r'C:\path\to\your\directory'`。

2. **权限**：
   - 确保你有足够的权限在指定目录下读取文件和写入文件。

3. **文件名冲突**：
   - 如果输出目录下已有同名文件，将会被覆盖。

## 示例

假设你的输入文件夹为 `C:\Users\Yi\Desktop\weibo_scraper\合并`，并且你想将合并后的文件保存在同一目录下，文件名为 `merged.docx`。

1. **编辑脚本**：
   - 修改 `input_directory` 和 `output_filename` 变量。

2. **运行脚本**：
   - 运行脚本：
     ```bash
     python merge_docx.py
     ```

## 联系方式

如有任何问题或建议，请在项目仓库中提交Issue。

---
